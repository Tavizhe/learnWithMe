# Laravel

## Pre Requirements

To start first install Xampp application then add php directory to your path in environment variables. Later check `php -v` in command line (CMD) to see the right version of php.

Next is time to install Composer. First download `Composer-Setup.exe` from [Composer Site](https://getcomposer.org/download/) then simply install it. After check composer version with Command Line with following command `composer -V`.

## Creating New Laravel Project Using Composer

To create a new project using Composer run in Command Line:

```shell
cd C:\xampp\htdocs
composer create-project laravel/laravel="*" Project_Name
# don't forget to add your exact php version instead of "*".
```

In order to use local host to check your made website use following command:

```shell
php artisan serve
```

by using this command in Command line or Power Shell (It's better to be used vscode terminal), an Host with an IP will be shown like `http://127.0.0.1:8000`. by clicking on it you will be directed to desired laravel website.

## Laravel Root Directory Structure

| Directory | Description                                                                                                                                    |
| --------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| app       | The app directory holds the base code for your Laravel application.                                                                            |
| bootstrap | The bootstrap directory contains all the bootstrapping scripts used for your application.                                                      |
| config    | The config directory holds all your project configuration files (.config).                                                                     |
| database  | The database directory contains your database files.                                                                                           |
| public    | The public directory helps start your Laravel project and maintains other necessary files such as JavaScript, CSS, and images of your project. |
| resources | The resources directory holds all the Sass files, language (localization) files, and templates (if any).                                       |
| routes    | The routes directory contains all your definition files for routing, such as console.php, api.php, channels.php, etc.                          |
| storage   | The storage directory holds your session files, cache, compiled templates, and miscellaneous files generated by the framework.                 |
| test      | The test directory holds all your test cases.                                                                                                  |
| vendor    | The vendor directory holds all composer dependency files.                                                                                      |

- You will need the `.env` file in the project's root directory to configure your application's environment. You can configure the database for your application using the `config/database.php` file of your project.

### App Directory Structure

| Directory     | Description                                                                                                                                                                                                                |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Console       | The Console directory contains all your project artisan commands.                                                                                                                                                          |
| Events        | The Events directory holds event files that your laravel application may pop up. Events are used for sending messages or signals to other parts of the laravel project that any action has taken place within the project. |
| Exceptions    | The Exceptions directory holds your laravel project's exception handling files, which handle all the exceptions thrown by your Laravel project.                                                                            |
| Http          | The Http directory holds different filters, requests, and controllers.                                                                                                                                                     |
| Jobs          | The Jobs directory holds all lineup jobs in this directory. But it does not get created initially; instead, you need to type and run this artisan command:`make:job`                                                       |
| Listeners     | The Listeners directory holds all your project's handler classes used for receiving and handling events.                                                                                                                   |
| Mail          | The Main directory holds all the emails sent through your Laravel project, and this directory needs to be created using the command: `make:mail`                                                                           |
| Notifications | The Notifications directory contains all your transactional notifications sent through your Laravel project, and this directory needs to be created using the command: `make:notification`                                 |
| Policies      | The policies directory holds different policies for your laravel project.                                                                                                                                                  |
| Providers     | The Providers directory is used to contain different service providers.                                                                                                                                                    |
| Rules         | The Rules directory holds all the different objects related to custom validation rules, and this directory needs to be created using the command: `make:rule`                                                              |

### Artisan

Artisan is a command-line interface (CLI) included with the Laravel PHP framework that provides several helpful commands for speeding up development workflows. use `php artisan list`
to see all commands.

> we can make our own commands and add them in artisan. first make scaffolding `php artisan make:command SendEmails` then implement your php codes in it.

## Routing

Routes are defined inside the Route folder in `api.php` and `web.php` files. in `api.php` we use to just use to return `JSON` in `API` formats.
Routing in Laravel allows you to route all your application requests to their appropriate controller. The application's route file gets defined in the `app/Http/routes.php` file. The general routing in Laravel for each of the possible requests looks something like this:

> Use `use Illuminate\Support\Facades\Route` in order to use routes in project.

![Routes in laravel](Laravel%20Images%20Reference/1.png)

```php
// http://localhost/
Route:: get ('/', function () {// '/' is the uri (means anything that comes after your root domain) and func is a controller that can be a method in our class or anonymous function!
   return view('Home');
})->('Home.index'); // this is how you can name your routes so they make sense by reading it

<!-- Another Example -->
// Defining a route that only renders a Blade template
Route::view('/Home'); // Without parameters
Route::view('/Home', ['data' => 'value']); // With parameters
```

- Roots that just returns HTML and don't require any parameters or any extra work, you can simplify like bellow:

```php
<!-- Before -->
Route::get('/', function() {
    return view('home,index', [])
})=>name('home.index');

<!-- After -->
Route::view('/', 'home.index')=>name('home.index');
```

- `php artisan route:list` Command shows all of routes in our project.

### The routing happens in three different steps

1. First of all, you have to create and run the root URL of your project.
2. The URL you run needs to be matched exactly with your method defined in the root.php file.
3. The function invokes the template files. It then calls the `view()` function with the file name located in `resources/views/`.

- It is good to know that routes have 4 functionalities like :`get()`,`post()`,`put()` and `delete()`.

![Route-functionalities](Laravel%20Images%20Reference/2.png)

#### Route Parameters

Laravel provides two ways of capturing the passed parameter:

- Required parameter (can be used for ids, postNumbers, ...): You sometimes had to work with a segment(s) of your project's URL (Uniform Resource Locator). Route parameters are encapsulated within {} (curly-braces) with alphabets inside. Let us take an example where you have to capture the customer's ID or employee from the generated URL. For Example:

```php
Route::get("posts/{id}", function ($id) {
  echo "Blog post " . $id;
});
```

- Optional Parameter (can be useful for time when name parameter is not provided): Many parameters do not remain present within the URL, but the developers had to use them. So such parameters get indicated by a "?" (question mark sign) following the parameter's name. For Example:

```php
Route::get("emp/{name?}", function ($name = "Guest") {
  echo $name;
});
Route::get("/recent-posts/{days_ago?}", function ($daysAgo = 20) {
  // it is necessary to have argument in optional parameters.
  return "Posts from " . $daysAgo . " days ago";
});
```

> Note - always name your routes! It is always wise to name our blade templates (views) as routes connected to them! Happy Coding.

In last Example the required parameter have to be a number, we can specify in route so it always be a number like Example bellow:

```php
Route :: get ('posts/{id}', function ($id) {
    echo 'Blog post '.$id;
})-> where([
    'id' => [0-9]+ // by using regular expressions. + means it should have a length of at least 1.
])->name('posts.show'); // don't forget to name your routes :)
```

> Note - we all know that ids are always a number. we should not always write `where(['id' => [0-9]+])`. To avoid repeating the code we do it in global, editing `app/provider/RouteServiceProvider.php` by adding repeated code as a pattern in line 49. For Example:`Route::pattern('id', '[0-9]+');`

## Views and Layouts

A view is a file containing a mix of PHP code, HTML markup, and Blade templates. These templates contain placeholders for dynamic content and are used to define the structure and layout of a web page. By default, Laravel comes with a set of predefined views, such as `welcome.blade.php` and `errors/404.blade.php`.

> Note: Views are stored in the `resources/views`.

### Creating a View

To create a view in Laravel, follow these steps:

1. Navigate to the `resources/views` directory in your Laravel project.
2. Create a new file with a `fileName.blade.php` extension. This extension tells Laravel to use the Blade template engine to parse the view.
3. In the view file, add the HTML, PHP, and/or Blade templates that define the structure and layout of the page. You can use placeholders for dynamic content, such as or.

For Example:

```php
<!-- resources/views/greeting.blade.php -->

<h1>Hello, {{$name}}!</h1> // $name is a placeholder for dynamic content
```

### Rendering a View

**View helper functions** can be used to display a view in a Laravel application. This function takes the name of the view as its first argument and an array of data as its second argument. For Example:

```php
// in a Laravel controller
return view("greeting", ["name" => "Alex"]);

// in routes/greeting.php
Route::get("/greeting", function () {
  return view("greeting", ["name" => "Alex"]);
});
```

As an alternative to passing a complete array of data to the view helper function, you may use the with method to add individual pieces of data to the view.

```php
return view('greeting')
            ->with('name', 'Victoria')
            ->with('occupation', 'Astronaut');
// or
<!-- web.php -->
Route::get('/posts/{id}', function($id){
    $posts = [
        1 => [
            'title' => 'Intro To laravel',
            'content' => 'This is a short intro to laravel'
        ],
        2 => [
            'title' => 'Intro to PHP',
            'content' => 'This is a short intro to PHP'
        ]
    ];
    abort_if(!isset($posts[$id]), 404); // this is a laravel helper function - generate an error (here is 404 not found) when this condition (inputted post id is not available) is met.
    return view('posts.show', ['post' => $posts[$id]]);
    });
<!-- Resources/views/posts/show.blade.php explained more in ### Layouts Usage -->
@extends('layouts.app')

@section('title', $post['title'])

@section('content')
<h1>{{ $post['title'] }}</h1>
<p>{{ $post['content'] }}</p>
@endsection
```

> "Dot" notation may be used to reference nested views. For example, if your view is stored at `resources/views/admin/profile.blade.php`, you may return it from one of your application's routes / controllers like so: `return view('admin.profile', $data);`
> Note: View directory names should not contain the `.` character.

### Sharing Data With All Views

Occasionally, you may need to share data with all views that are rendered by your application. You may do so using the `View` facade's `share` method in `App\Providers\AppServiceProvider`.

```php
namespace App\Providers;

use Illuminate\Support\Facades\View;

class AppServiceProvider extends ServiceProvider
{
  /**
   * Register any application services.
   */
  public function register(): void
  {
    // ...
  }

  /**
   * Bootstrap any application services.
   */
  public function boot(): void
  {
    View::share("key", "value");
  }
}
```

### View Composers

View composers are callbacks or class methods that are called when a view is rendered. If you have data that you want to be bound to a view each time that view is rendered, a view composer can help you organize that logic into a single location. View composers may prove particularly useful if the same view is returned by multiple routes or controllers within your application and always needs a particular piece of data.

Typically, view composers will be registered within one of your application's [service providers](/docs/{{version}}/providers). In this example, we'll assume that we have created a new `App\Providers\ViewServiceProvider` to house this logic.

We'll use the `View` facade's `composer` method to register the view composer. Laravel does not include a default directory for class based view composers, so you are free to organize them however you wish. For example, you could create an `app/View/Composers` directory to house all of your application's view composers:

```php
namespace App\Providers;

use App\View\Composers\ProfileComposer;
use Illuminate\Support\Facades;
use Illuminate\Support\ServiceProvider;
use Illuminate\View\View;

class ViewServiceProvider extends ServiceProvider
{
  /**
   * Register any application services.
   */
  public function register(): void
  {
    // ...
  }

  /**
   * Bootstrap any application services.
   */
  public function boot(): void
  {
    // Using class based composers...
    Facades\View::composer("profile", ProfileComposer::class);

    // Using closure based composers...
    Facades\View::composer("welcome", function (View $view) {
      // ...
    });

    Facades\View::composer("dashboard", function (View $view) {
      // ...
    });
  }
}
```

### Layouts Usage

while coding a site there is always a chance that we are using the same html or any frontend code over and over, layouts simplify this method using directives like `@yield`. Directives always start with an at sign like `@` followed by the directive name and optionally they can have arguments.

- Yield Directive - The Yields Directive takes the name of the section it should render in the layout file, Using `@extends(`layout_file_name`)` and `@section('content')` ends with `@endsection`. Now, inside these two section directives, you can put all the HTML and content that should be rendered from.
  > Note: Layouts are stored in the `resources/layouts`. For Example:

```php
<!-- in resources/views/layouts/app.blade.php -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laravel App - @yield('title')</title>
</head>
<body>
    <div>
        @yield('content')
    </div>
</body>
</html>

<!-- in resources/views/index.blade.php or any other place we want to use `app.blade.php` as our layout -->
@extends('layouts.app')

@section('title', 'Home Page')

@section('content')
<h1>Hello World</h1>
@endsection
```

### Conditional Rendering

Sometimes our templates need some logic, for example, only if certain condition is true, you want to display some content, like is user logged in?

```php
Route::get('/posts/{id}', function($id){
    $post = [
        1 => [
            'title' => 'Intro To laravel',
            'content' => `This is a short intro to laravel`,
            'is_new' => true
        ],
        2 => [
            'title' => 'Intro to PHP',
            'content' => 'This is a short intro to PHP',
            'is_new' => false
        ]
    ];
    abort_if(!isset($post[$id]), 404);
    return view('posts.show', ['post' => $post[$id]]);
    });

<!-- show.blade.php to render content based on a condition, we will use the if directive. -->

@extends('layouts.app')

@section('title', $post['title'])

@section('content')
@if($post['is_new'])
<div>A new blog post, using if</div>
@elseif(!$post['is_new'])
<div> Blog post is old</div>
@endif
<h1>{{ $post['title'] }}</h1>
<p>{{ $post['content'] }}</p>
@endsection
```

- alternatively, to use Conditional Rendering using right Directive called `@unless()` that condition has to be false and no other alternatives, then `endunless()`.

```php
<!-- in this example we use last question answered in `@unless()` condition. -->
@unless ($post['is_new'])
    <p>There is newer post using unless Directive</p>
@endunless
```

- we can also add comments using `isset()` Directive like bellow:

```php
@extends('layouts.app')

@section('title', $post['title'])

@section('content')

@unless ($post['is_new'])
    <p>There is newer post using unless Directive</p>
@endunless

@isset($post['has_comments'])
    <div>this post has some comments. using `isset()` directives</div>
@endisset
```

> there are more Directives that uses further laravel knowledge that we will add later.

#### loops
